# Template Filler App

Приложение для заполнения шаблонных документов, позволяющее:

- **Выбирать шаблон** с диска (поддерживаются форматы Word (.docx) и Excel (.xlsx))
- **Сканировать шаблон** для обнаружения плейсхолдеров (элементы вида `{{FieldName}}`)
- **Формировать список полей** с определением типа (числовое или строковое) и описанием для каждого поля
- **Ограничивать ввод** для числовых полей (разрешаются только цифры, точка и знак минус)
- **Генерировать итоговый документ** с заменой плейсхолдеров на введённые данные
- **Сохранять документ** на диск или отправлять его по email
- **Логировать операции** в базе данных PostgreSQL и сохранять логи в документе

## Функциональные возможности

- **Выбор шаблона**  
  Пользователь выбирает файл-шаблон через диалоговое окно. Приложение определяет тип шаблона (DOCX или XLSX) и сохраняет путь к файлу.

- **Сканирование шаблона**  
  Приложение сканирует документ, ищет плейсхолдеры (например, `{{Имя}}`) и формирует массив плейсхолдеров (МП). Для каждого поля определяется тип (например, если имя содержит "сумм", "цена" или "кол", тип — числовой) и добавляется краткое описание.

- **Заполнение шаблона**  
  Пользователь вводит данные в форму. Для полей с типом числовых значений реализовано ограничение ввода.

- **Генерация документа**  
  Приложение заменяет плейсхолдеры на введённые данные и генерирует итоговый документ в исходном формате шаблона.

- **Сохранение/Отправка документа**  
  Итоговый документ можно сохранить на диск или отправить по email через SMTP.

- **Логирование операций**  
  Каждое действие (выбор шаблона, сканирование, заполнение, генерация, сохранение, отправка email) логируется в базу данных PostgreSQL. Дополнительно можно сохранить логи в виде документа Word.

## Используемые технологии

- **Язык программирования:** C#
- **Платформа:** .NET (WPF)
- **Библиотеки:**
  - [EPPlus](https://github.com/EPPlusSoftware/EPPlus) — работа с Excel
  - [DocX](https://github.com/xceedsoftware/DocX) — работа с Word
  - [Npgsql](https://www.npgsql.org/) — подключение к PostgreSQL
- **База данных:** PostgreSQL

## Установка и запуск

1. **Клонируйте репозиторий:**
   ```bash
   git clone https://github.com/your-repo/template-filler-app.git
    ```

2. Откройте решение в Visual Studio.
3. Установите NuGet-пакеты:
* EPPlus
* DocX
* Npgsql
4. Настройте строку подключения в файле Logger.cs под вашу базу PostgreSQL.
5. Соберите решение и запустите приложение.

## Использование
1. Выбор шаблона:
  Нажмите кнопку "Выбрать шаблон" и выберите документ (Word или Excel).

2. Сканирование шаблона:
  Приложение анализирует документ, формирует массив плейсхолдеров и отображает список полей (имя, описание, тип).

3. Заполнение полей:
  Введите данные в форму. Для числовых полей ввод ограничен разрешёнными символами.

4. Генерация документа:
  Нажмите кнопку "Заполнить шаблон" — приложение заменит плейсхолдеры на введённые данные и сформирует итоговый документ.

5. Сохранение/Отправка:
  Выберите, сохранить документ на диск или отправить его по email.

6. Сохранение логов:
  Нажмите кнопку "Сохранить логи" для формирования и сохранения документа с историей операций.


В проекте использованы следующие диаграммы для описания архитектуры и алгоритмов работы:

## Диаграммы и архитектура
В проекте использованы следующие диаграммы для описания архитектуры и алгоритмов работы:

### Архитектура 2 уровневая
![image](https://github.com/user-attachments/assets/56645915-17e7-4090-983a-cd513c625780)

## Архитектура 3 уровневая
![image](https://github.com/user-attachments/assets/057a282a-77e5-4c18-8b08-b24e0fca2aa3)


### Диаграмма последовательности
![image](https://github.com/user-attachments/assets/4c531f6c-69ce-472e-b3e4-da7a96cfa0ce)

### Диаграмма прецедентов Use-Case
![image](https://github.com/user-attachments/assets/d84f9e7c-f70e-41c9-8f76-1edb8f18b132)

### Диаграмма состояний
![image](https://github.com/user-attachments/assets/0b9aa1be-936c-4b69-9395-287176091adc)

### Диаграмма общего алгоритма
![image](https://github.com/user-attachments/assets/26375d33-a20b-4359-8bea-d0a21b270eba)

Вариант 2. Подробнее

![image](https://github.com/user-attachments/assets/e6c2e2b4-4e64-4180-ae07-d9ac236f8109)


### Алгоритмы: сканирование шаблона, замена плейсхолдеров и др.
![image](https://github.com/user-attachments/assets/73b9abd3-03cf-4578-9e16-78f6bdff0237)
![image](https://github.com/user-attachments/assets/460fe396-e079-4990-83b7-9caa33819cfa)
![image](https://github.com/user-attachments/assets/d876ab06-82cb-400f-9f3d-d28c8107cd53)


