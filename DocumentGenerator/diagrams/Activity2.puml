@startuml
start

:Запуск приложения;
:Отображение главного окна;
:Нажатие кнопки "Выбрать шаблон";
:Открытие диалогового окна для выбора файла;
if (Шаблон выбран?) then (да)
  :Сохранение пути к шаблону;
  :Определение типа шаблона (Word или Excel);
  :Логирование "Выбор шаблона";
  
  partition "Парсинг шаблона" {
    if (Шаблон = DOCX?) then (да)
      :Использование механизма Word;
    else (нет)
      :Использование механизма Excel;
    endif
    :Формирование списка полей;
    :Для каждого поля установить:
    - Название
    - Тип (Numeric или String) на основе ключевых слов
    - Описание (предопределенное описание);
  }
  
  :Отображение списка полей в UI;
else
  :Операция отменена;
  stop
endif

:Пользователь вводит значения в поля;
:Ограничение ввода для числовых полей (разрешены только цифры и допустимые символы);
:Нажатие кнопки "Заполнить шаблон";
:Замена плейсхолдеров в шаблоне на введенные данные;
:Логирование "Заполнение шаблона";
:Генерация итогового документа (формат определяется типом шаблона);

partition "Финальные действия" {
  :Отображение сгенерированного документа;
  if (Пользователь выбирает "Сохранить документ"?) then (да)
    :Открытие диалогового окна сохранения файла;
    :Сохранение документа в соответствующем формате;
    :Логирование "Сохранение документа";
  else
    if (Пользователь выбирает "Отправить email"?) then (да)
      :Запрос адреса получателя;
      :Отправка email с вложением документа;
      :Логирование "Отправка email";
    endif
  endif
}

:Нажатие кнопки "Сохранить логи";
:Извлечение логов из базы данных;
:Генерация документа (DOCX) с информацией о логах;
:Открытие диалогового окна сохранения логов;
:Сохранение файла с логами;
:Логирование "Сохранение логов";

stop
@enduml
