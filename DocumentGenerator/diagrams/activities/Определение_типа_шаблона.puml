@startuml
start
title "Определение типа шаблона"

:Получить путь к выбранному шаблону;
:Вызвать процедуру "Определение типа шаблона";
note right
  Функция "Определение типа шаблона":
  - Проверка расширения файла
  - Если расширение .docx → шаблон Word
  - Если расширение .xlsx → шаблон Excel
  - Иначе, вернуть ошибку "Неподдерживаемый формат"
end note

if (Тип шаблона определён?) then (да)
  :Записать тип шаблона (Word/Excel);
  
  :Вызвать процедуру "Формирование списка полей";
  note right
    Функция "Формирование списка полей":
    - Сканирование документа (Word или Excel)
    - Поиск плейсхолдеров вида {{FieldName}}
    - Для каждого найденного поля:
      • Создать объект Field
      • Установить имя поля
      • Определить тип (Numeric или String) по ключевым словам (например, "сумма", "цена")
      • Добавить описание (например, "Описание для <FieldName>")
  end note
  
  :Получить список полей и отобразить их в UI;
  
  :Пользователь вводит значения в поля;
  :При вводе для полей с типом Numeric вызвать процедуру "Ограничение ввода";
  note right
    Процедура "Ограничение ввода":
    - Проверка вводимых символов
    - Разрешены только цифры, десятичная точка и знак минус
  end note

  :Вызвать процедуру "Замена плейсхолдеров";
  note right
    Функция "Замена плейсхолдеров":
    - Пройти по всему документу
    - Найти каждый плейсхолдер вида {{FieldName}}
    - Заменить его на соответствующее введённое значение
  end note
  
  :Генерация итогового документа;
  if (Ошибки?) then (нет)
  :сохранение/отправка документа.;
else (да)
  :Вывести сообщение об ошибке "Неподдерживаемый формат";
endif
:Сохранение логов;

stop
@enduml
